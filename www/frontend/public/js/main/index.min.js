"use strict";define("ItemsEdge",["includeModules"],function(e){var t=Mn.View.extend({getTemplate:function(){return _.template('<a href="'+this.prepare()+'" class="<%- Code %>" ><span><%- Title %></span><span class="help" title="<%- Description %>"></span></a>')},events:{"click .help":function(e){e.preventDefault()}},prepare:function(){function e(e){for(var t=location.pathname.split("/"),n=0;n<t.length;n++){var i=t[n];if(-1!==i.indexOf(e))return i}for(var l=location.search.substring(1).split("&"),a=0;a<l.length;a++)if(i=l[a],-1!==i.indexOf(e))return i.split("=")[1];return 0}var t=this.model.toJSON();if(!t.Enabled)return"#";if(t.UrlAbsolute)return t.Url;var n=e("lang")||"lang-ru-RU",i=e("db")||"db0",l=t.Url.replace("{lang}",n);return l=-1===t.Url.indexOf("{db}")?l+"?db="+i:l.replace("{db}",i)}});return Mn.CollectionView.extend({childView:Mn.View.extend({template:_.template("<h3><%- GroupTitle %></h3>"),onRender:function(){this.$el.addClass(this.model.get("ClassName")),this.$el.attr("role","navigation");var n=_.chain(this.model.get("Edges")).filter(function(t){return-1!==e.indexOf(t.Code)}).toArray().value();n.length||this.$el.hide(),1===n.length&&(this.$("h3").hide(),n[0].Code=n[0].Code+" onlyYou"),_.each(n,function(e){var e=new t({model:new Backbone.Model(e)}).render();this.$el.append(e.$el)},this)}})})}),define(["access","ItemsEdge","global.view.headerView"],function(e,t,n){return{init:function(){$.ajaxSetup({headers:{key:$.ajaxSettings.url}}),(new(Mn.Application.extend({region:".items-edge",onStart:function(){var i=e.data.Edges;this.showView(new t({collection:new Backbone.Collection(i)})),new n({isDemo:!0}).render()}}))).start(),$("#news, .control").click(function(){$(".apps").toggleClass("collapsed"),$(".feed").toggleClass("hidden"),$(this).parent("li").toggleClass("active")}),$(".feed--item .close").click(function(){$(this).parent(".feed--item").addClass("removed"),setTimeout(function(){$(this).parent(".feed--item").remove()}.bind(this),300)})}}});