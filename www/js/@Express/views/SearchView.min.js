define(["app","i18n!nls/resources","@/views/SelectView","@/views/ListView","RU","syncfusion"],function(n,t,i,r){"use strict";var u='<section><div class="form-group"><input type="text" id="inputFilter" class="form-control" /><span class="push"><\/span><\/div><div class="form-inline"><div class="form-group"><p class="help-block"><%= Resources.seek %><\/p><select id="typeFilter" class="form-control"><\/select><\/div><div class="form-group input-date"><p class="help-block"><%= Resources.period %><\/p><label for="datepickerFrom"><%= Resources.from %><\/label>&nbsp;<input style="width:120px;" type="text" id="datepickerFrom" class="form-control"><span class="sep">&nbsp;<\/span><label for="datepickerTo"><%= Resources.to %><\/label>&nbps;<input style="width:120px;" type="text" id="datepickerTo" class="form-control"><\/div><div class="pull-right"><button id="startFilter" class=""><%= Resources.search %><\/button><\/div><\/div><\/section><p class="result-info text-center"><\/p><div class="result"><\/div>',f=Backbone.Model.extend({defaults:{onlyMeta:null,typeID:null,paramID:null,profileID:null,ds:null,de:null,inputText:"",top:null}});return Backbone.View.extend({el:$("#search-checks"),page:"1",currentid:"-1",events:{"click #startFilter":"start","keyup #inputFilter":"contr","click .push":"clearControl"},clearControl:function(){this.$("#inputFilter").val("");this.$(".push").fadeOut()},contr:function(n){$(n.target).val()?this.$(".push").fadeIn():this.$(".push").fadeOut()},start:function(){this.setParams();this.run()},run:function(){n.Select.set("detail",$.param(this.filter.toJSON()));n.navigate(n.Select.fullpath());var i=new r({el:this.$(".result")});i.collection.url="/api/interestObjects?"+$.param(this.filter.toJSON());i.newPage=n.Select.get("page");i.fetch().done(function(n){var i=n.collection.at(0).get("pagination").totalItems;i?this.$(".result-info").text(t.searchresult+i):this.$(".result-info").text(t.noresult)},this);this.listenTo(i,"to:page",function(n){i.newPage=n;i.fetch()})},initialize:function(){this.filter=new f},render:function(){return this.$el.html(_.template(u)({Resources:t})),this.$("#datepickerFrom").ejDatePicker({locale:t.Lang,buttonText:t.Today}),this.$("#datepickerTo").ejDatePicker({locale:t.Lang,buttonText:t.Today}),this},fill:function(){var t=n.Select.getObjectByParam(n.Select.get("detail")),r=t?t.typeID:null;return t&&(this.filter.set(t,{silent:!0}),t.inputText&&(this.$("#inputFilter").val(decodeURIComponent(t.inputText).replace(/[\+]/g," ")),this.$(".push").fadeIn()),t.ds&&this.$("#datepickerFrom").ejDatePicker({value:new Date(t.ds)}),t.de&&this.$("#datepickerTo").ejDatePicker({value:new Date(t.de)})),this.t=new i({el:this.$("#typeFilter"),url:function(){return"/api/searchTypes"},done:function(){r&&this.$el.find("option[value="+r+"]").attr("selected",!0)}}).fetch(),this},setParams:function(){this.filter.set({onlyMeta:"",profileID:0,typeID:this.t.$el.val(),paramID:null,inputText:$.trim(this.$("#inputFilter").val()),ds:$.ToISO(this.$("#datepickerFrom").data("ejDatePicker").getValue()),de:$.ToISO(this.$("#datepickerTo").data("ejDatePicker").getValue()),top:null},arguments[0]?arguments[0]:{})},done:function(n){this.callback=n}})});